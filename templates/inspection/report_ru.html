{% extends "inspection/base.html" %}

{% block content %}
<div class="inspection-report">
    <!-- –í—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–∏–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ -->
    <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; display: none;" id="debug-info">
        <strong>–û—Ç–ª–∞–¥–∫–∞:</strong>
        <div>–í—Å–µ–≥–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π: {{ report_data.damage_points|length }}</div>
        <div>–î–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π: {{ report_data.damage_points }}</div>
    </div>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
        <h1>{{ report_data.translations.title }}</h1>
        <div class="vehicle-info">
            <div class="info-grid">
                <div><strong>–ú–æ–¥–µ–ª—å:</strong> {{ report_data.car_model }}</div>
                <div><strong>–ì–æ–¥:</strong> {{ report_data.car_year }}</div>
                <div><strong>VIN:</strong> {{ report_data.vin }}</div>
                <div><strong>–ü—Ä–æ–±–µ–≥:</strong> {{ report_data.mileage }} {{ report_data.translations.km_label }}</div>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="section">
        <h3>{{ report_data.translations.general_condition_label }}</h3>
        <div class="info-grid detailed">
            <div><strong>{{ report_data.translations.first_reg_label }}:</strong> {{ report_data.first_registration_date }}</div>
            <div><strong>{{ report_data.translations.transmission_label }}:</strong> {{ report_data.transmission_type }}</div>
            <div><strong>{{ report_data.translations.fuel_label }}:</strong> {{ report_data.fuel_type }}</div>
            <div><strong>{{ report_data.translations.warranty_label }}:</strong> {{ report_data.warranty_type }}</div>
            <div><strong>{{ report_data.translations.engine_label }}:</strong> {{ report_data.engine_type }}</div>
            <div><strong>{{ report_data.translations.odometer_label }}:</strong> {{ report_data.mileage_condition }}</div>
            <div><strong>{{ report_data.translations.vin_label }}:</strong> {{ report_data.vin_condition }}</div>
            <div><strong>{{ report_data.translations.tuning_label }}:</strong> {{ report_data.tuning_status }}</div>
            <div><strong>{{ report_data.translations.special_history_label }}:</strong> {{ report_data.special_history }}</div>
            <div><strong>{{ report_data.translations.purpose_change_label }}:</strong> {{ report_data.purpose_change }}</div>
            <div><strong>{{ report_data.translations.accident_label }}:</strong> {{ report_data.accident_history }}</div>
            <div><strong>{{ report_data.translations.simple_repair_label }}:</strong> {{ report_data.simple_repair }}</div>
        </div>
    </div>

    <!-- –°—Ö–µ–º—ã –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π -->
    <div class="section">
        <h3>–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –∫—É–∑–æ–≤–∞</h3>
        {{ report_data.svg_schemes|safe }}
    </div>

    <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
    {% if report_data.damage_points %}
    <div class="section">
        <h3>–õ–µ–≥–µ–Ω–¥–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π</h3>
        <div class="legend">
            {% for damage_type, data in report_data.damage_points.items() %}
            <div class="legend-item">
                <div class="legend-color" style="background: {{ data.color }};"></div>
                <span>{{ damage_type }} ({{ data.count }})</span>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
    <div class="section">
        <h3>{{ report_data.translations.detailed_condition_label }}</h3>
        {{ report_data.diagnosis_sections|safe }}
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Ä–µ–º–æ–Ω—Ç–æ–≤ -->
    <div class="section">
        <h3>–†–µ–º–æ–Ω—Ç—ã –∏ –∑–∞–º–µ–Ω—ã –¥–µ—Ç–∞–ª–µ–π</h3>
        {{ report_data.repair_list|safe }}
    </div>

    <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ -->
    <div style="text-align: center; color: #666; font-style: italic; margin: 20px 0;">
        {{ report_data.translations.note_text }}
    </div>

    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
    <div class="controls">
        <button onclick="window.print()">üñ® –ü–µ—á–∞—Ç—å</button>
        <a href="?lang=en" class="lang-btn">üåê English</a>
        <button onclick="toggleDebug()">üêõ –û—Ç–ª–∞–¥–∫–∞</button>
        <button onclick="window.close()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
function toggleDebug() {
    const debugInfo = document.getElementById('debug-info');
    debugInfo.style.display = debugInfo.style.display === 'block' ? 'none' : 'block';
}
</script>
{% endblock %}